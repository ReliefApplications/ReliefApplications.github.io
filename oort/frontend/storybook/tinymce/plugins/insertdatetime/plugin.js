!function(){"use strict";var global$1=tinymce.util.Tools.resolve("tinymce.PluginManager"),getTimeFormat=function(editor){return editor.getParam("insertdatetime_timeformat",editor.translate("%H:%M:%S"))},getFormats=function(editor){return editor.getParam("insertdatetime_formats",["%H:%M:%S","%Y-%m-%d","%I:%M:%S %p","%D"])},daysShort="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),daysLong="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),monthsShort="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),monthsLong="January February March April May June July August September October November December".split(" "),addZeros=function(value,len){if((value=""+value).length<len)for(var i=0;i<len-value.length;i++)value="0"+value;return value},getDateTime=function(editor,fmt,date){return void 0===date&&(date=new Date),fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=(fmt=fmt.replace("%D","%m/%d/%Y")).replace("%r","%I:%M:%S %p")).replace("%Y",""+date.getFullYear())).replace("%y",""+date.getYear())).replace("%m",addZeros(date.getMonth()+1,2))).replace("%d",addZeros(date.getDate(),2))).replace("%H",""+addZeros(date.getHours(),2))).replace("%M",""+addZeros(date.getMinutes(),2))).replace("%S",""+addZeros(date.getSeconds(),2))).replace("%I",""+((date.getHours()+11)%12+1))).replace("%p",date.getHours()<12?"AM":"PM")).replace("%B",""+editor.translate(monthsLong[date.getMonth()]))).replace("%b",""+editor.translate(monthsShort[date.getMonth()]))).replace("%A",""+editor.translate(daysLong[date.getDay()]))).replace("%a",""+editor.translate(daysShort[date.getDay()]))).replace("%%","%")},insertDateTime=function(editor,format){if(function(editor){return editor.getParam("insertdatetime_element",!1)}(editor)){var userTime=getDateTime(editor,format),computerTime=void 0;computerTime=/%[HMSIp]/.test(format)?getDateTime(editor,"%Y-%m-%dT%H:%M"):getDateTime(editor,"%Y-%m-%d");var timeElm=editor.dom.getParent(editor.selection.getStart(),"time");timeElm?function(editor,timeElm,computerTime,userTime){var newTimeElm=editor.dom.create("time",{datetime:computerTime},userTime);timeElm.parentNode.insertBefore(newTimeElm,timeElm),editor.dom.remove(timeElm),editor.selection.select(newTimeElm,!0),editor.selection.collapse(!1)}(editor,timeElm,computerTime,userTime):editor.insertContent('<time datetime="'+computerTime+'">'+userTime+"</time>")}else editor.insertContent(getDateTime(editor,format))},global=tinymce.util.Tools.resolve("tinymce.util.Tools"),register=function(editor){var initial,value,formats=getFormats(editor),defaultFormat=(initial=function(editor){var formats=getFormats(editor);return formats.length>0?formats[0]:getTimeFormat(editor)}(editor),value=initial,{get:function(){return value},set:function(v){value=v}}),insertDateTime=function(format){return editor.execCommand("mceInsertDate",!1,format)};editor.ui.registry.addSplitButton("insertdatetime",{icon:"insert-time",tooltip:"Insert date/time",select:function(value){return value===defaultFormat.get()},fetch:function(done){done(global.map(formats,(function(format){return{type:"choiceitem",text:getDateTime(editor,format),value:format}})))},onAction:function(_api){insertDateTime(defaultFormat.get())},onItemAction:function(_api,value){defaultFormat.set(value),insertDateTime(value)}});var makeMenuItemHandler=function(format){return function(){defaultFormat.set(format),insertDateTime(format)}};editor.ui.registry.addNestedMenuItem("insertdatetime",{icon:"insert-time",text:"Date/time",getSubmenuItems:function(){return global.map(formats,(function(format){return{type:"menuitem",text:getDateTime(editor,format),onAction:makeMenuItemHandler(format)}}))}})};!function Plugin(){global$1.add("insertdatetime",(function(editor){!function(editor){editor.addCommand("mceInsertDate",(function(_ui,value){insertDateTime(editor,null!=value?value:function(editor){return editor.getParam("insertdatetime_dateformat",editor.translate("%Y-%m-%d"))}(editor))})),editor.addCommand("mceInsertTime",(function(_ui,value){insertDateTime(editor,null!=value?value:getTimeFormat(editor))}))}(editor),register(editor)}))}()}();