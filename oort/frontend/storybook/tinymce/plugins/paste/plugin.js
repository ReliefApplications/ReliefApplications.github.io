!function(){"use strict";var type,call,id,prefix,count,Cell=function(initial){var value=initial;return{get:function(){return value},set:function(v){value=v}}},global$b=tinymce.util.Tools.resolve("tinymce.PluginManager"),isArray=(type="array",function(value){return t=typeof(x=value),(null===x?"null":"object"===t&&(Array.prototype.isPrototypeOf(x)||x.constructor&&"Array"===x.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(x)||x.constructor&&"String"===x.constructor.name)?"string":t)===type;var x,t}),isNonNullable=function(a){return!function(a){return null==a}(a)},isFunction=function(type){return function(value){return typeof value===type}}("function"),noop=function(){},constant=function(value){return function(){return value}},identity=function(x){return x},never=constant(!1),always=constant(!0),none=function(){return NONE},NONE={fold:function(n,_s){return n()},isSome:never,isNone:always,getOr:id=identity,getOrThunk:call=function(thunk){return thunk()},getOrDie:function(msg){throw new Error(msg||"error: getOrDie called on none.")},getOrNull:constant(null),getOrUndefined:constant(void 0),or:id,orThunk:call,map:none,each:noop,bind:none,exists:never,forall:always,filter:function(){return none()},toArray:function(){return[]},toString:constant("none()")},some=function(a){var constant_a=constant(a),self=function(){return me},bind=function(f){return f(a)},me={fold:function(n,s){return s(a)},isSome:always,isNone:never,getOr:constant_a,getOrThunk:constant_a,getOrDie:constant_a,getOrNull:constant_a,getOrUndefined:constant_a,or:self,orThunk:self,map:function(f){return some(f(a))},each:function(f){f(a)},bind:bind,exists:bind,forall:bind,filter:function(f){return f(a)?me:NONE},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return me},Optional={some:some,none:none,from:function(value){return null==value?NONE:some(value)}},nativeSlice=Array.prototype.slice,nativePush=Array.prototype.push,exists=function(xs,pred){for(var i=0,len=xs.length;i<len;i++){if(pred(xs[i],i))return!0}return!1},map=function(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r},each=function(xs,f){for(var i=0,len=xs.length;i<len;i++){f(xs[i],i)}},bind=function(xs,f){return function(xs){for(var r=[],i=0,len=xs.length;i<len;++i){if(!isArray(xs[i]))throw new Error("Arr.flatten item "+i+" was not an array, input: "+xs);nativePush.apply(r,xs[i])}return r}(map(xs,f))},from=isFunction(Array.from)?Array.from:function(x){return nativeSlice.call(x)},__assign=function(){return(__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},value=function(){var subject=function(doRevoke){var subject=Cell(Optional.none()),revoke=function(){return subject.get().each(doRevoke)};return{clear:function(){revoke(),subject.set(Optional.none())},isSet:function(){return subject.get().isSome()},get:function(){return subject.get()},set:function(s){revoke(),subject.set(Optional.some(s))}}}(noop);return __assign(__assign({},subject),{on:function(f){return subject.get().each(f)}})},checkRange=function(str,substr,start){return""===substr||str.length>=substr.length&&str.substr(start,start+substr.length)===substr},global$a=tinymce.util.Tools.resolve("tinymce.Env"),global$9=tinymce.util.Tools.resolve("tinymce.util.Delay"),global$8=tinymce.util.Tools.resolve("tinymce.util.Promise"),global$7=tinymce.util.Tools.resolve("tinymce.util.VK"),firePastePlainTextToggle=function(editor,state){return editor.fire("PastePlainTextToggle",{state:state})},global$6=tinymce.util.Tools.resolve("tinymce.util.Tools"),shouldPasteDataImages=function(editor){return editor.getParam("paste_data_images",!1)},shouldMergeFormats=function(editor){return editor.getParam("paste_merge_formats",!0)},getRetainStyleProps=function(editor){return editor.getParam("paste_retain_style_properties")},getValidate=function(editor){return editor.getParam("validate")},getAllowHtmlDataUrls=function(editor){return editor.getParam("allow_html_data_urls",!1,"boolean")},getPasteDataImages=function(editor){return editor.getParam("paste_data_images",!1,"boolean")},getAllowedImageFileTypes=function(editor){return global$6.explode(editor.getParam("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"))},isMarked=function(html){return-1!==html.indexOf("\x3c!-- x-tinymce/html --\x3e")},internalHtmlMime=constant("x-tinymce/html"),hasOwnProperty=Object.hasOwnProperty,has=function(obj,key){return hasOwnProperty.call(obj,key)},global$5=tinymce.util.Tools.resolve("tinymce.html.Entities"),toBlockElements=function(text,rootTag,rootAttrs){var blocks=text.split(/\n\n/),tagOpen=function(rootTag,rootAttrs){var attrs=[],tag="<"+rootTag;if("object"==typeof rootAttrs){for(var key in rootAttrs)has(rootAttrs,key)&&attrs.push(key+'="'+global$5.encodeAllRaw(rootAttrs[key])+'"');attrs.length&&(tag+=" "+attrs.join(" "))}return tag+">"}(rootTag,rootAttrs),tagClose="</"+rootTag+">",paragraphs=global$6.map(blocks,(function(p){return p.split(/\n/).join("<br />")}));return 1===paragraphs.length?paragraphs[0]:global$6.map(paragraphs,(function(p){return tagOpen+p+tagClose})).join("")},global$4=tinymce.util.Tools.resolve("tinymce.html.DomParser"),global$3=tinymce.util.Tools.resolve("tinymce.html.Serializer"),global$2=tinymce.util.Tools.resolve("tinymce.html.Node"),global$1=tinymce.util.Tools.resolve("tinymce.html.Schema"),filter=function(content,items){return global$6.each(items,(function(v){content=v.constructor===RegExp?content.replace(v,""):content.replace(v[0],v[1])})),content},trimHtml=function(html){return html=filter(html,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,function(all,s1,s2){return s1||s2?" ":" "}],/<br class="Apple-interchange-newline">/g,/<br>$/i])},isWordContent=function(content){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(content)||/class="OutlineElement/.test(content)||/id="?docs\-internal\-guid\-/.test(content)},isNumericList=function(text){var found=!1;return text=text.replace(/^[\u00a0 ]+/,""),global$6.each([/^[IVXLMCD]+\.[ \u00a0]/,/^[ivxlmcd]+\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],(function(pattern){if(pattern.test(text))return found=!0,!1})),found},filterStyles=function(editor,validStyles,node,styleValue){var outputStyles={},styles=editor.dom.parseStyle(styleValue);global$6.each(styles,(function(value,name){switch(name){case"mso-list":var matches=/\w+ \w+([0-9]+)/i.exec(styleValue);matches&&(node._listLevel=parseInt(matches[1],10)),/Ignore/i.test(value)&&node.firstChild&&(node._listIgnore=!0,node.firstChild._listIgnore=!0);break;case"horiz-align":name="text-align";break;case"vert-align":name="vertical-align";break;case"font-color":case"mso-foreground":name="color";break;case"mso-background":case"mso-highlight":name="background";break;case"font-weight":case"font-style":return void("normal"!==value&&(outputStyles[name]=value));case"mso-element":if(/^(comment|comment-list)$/i.test(value))return void node.remove()}0!==name.indexOf("mso-comment")?0!==name.indexOf("mso-")&&("all"===getRetainStyleProps(editor)||validStyles&&validStyles[name])&&(outputStyles[name]=value):node.remove()})),/(bold)/i.test(outputStyles["font-weight"])&&(delete outputStyles["font-weight"],node.wrap(new global$2("b",1))),/(italic)/i.test(outputStyles["font-style"])&&(delete outputStyles["font-style"],node.wrap(new global$2("i",1)));var outputStyle=editor.dom.serializeStyle(outputStyles,node.name);return outputStyle||null},filterWordContent=function(editor,content){var validStyles,retainStyleProperties=getRetainStyleProps(editor);retainStyleProperties&&(validStyles=global$6.makeMap(retainStyleProperties.split(/[, ]/))),content=filter(content,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(str,spaces){return spaces.length>0?spaces.replace(/./," ").slice(Math.floor(spaces.length/2)).split("").join(" "):""}]]);var validElements=function(editor){return editor.getParam("paste_word_valid_elements","-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody")}(editor),schema=global$1({valid_elements:validElements,valid_children:"-li[p]"});global$6.each(schema.elements,(function(rule){rule.attributes.class||(rule.attributes.class={},rule.attributesOrder.push("class")),rule.attributes.style||(rule.attributes.style={},rule.attributesOrder.push("style"))}));var domParser=global$4({},schema);domParser.addAttributeFilter("style",(function(nodes){for(var node,i=nodes.length;i--;)(node=nodes[i]).attr("style",filterStyles(editor,validStyles,node,node.attr("style"))),"span"===node.name&&node.parent&&!node.attributes.length&&node.unwrap()})),domParser.addAttributeFilter("class",(function(nodes){for(var node,className,i=nodes.length;i--;)className=(node=nodes[i]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(className)&&node.remove(),node.attr("class",null)})),domParser.addNodeFilter("del",(function(nodes){for(var i=nodes.length;i--;)nodes[i].remove()})),domParser.addNodeFilter("a",(function(nodes){for(var node,href,name,i=nodes.length;i--;)if(href=(node=nodes[i]).attr("href"),name=node.attr("name"),href&&-1!==href.indexOf("#_msocom_"))node.remove();else if(href&&0===href.indexOf("file://")&&(href=href.split("#")[1])&&(href="#"+href),href||name){if(name&&!/^_?(?:toc|edn|ftn)/i.test(name)){node.unwrap();continue}node.attr({href:href,name:name})}else node.unwrap()}));var rootNode=domParser.parse(content);return function(editor){return editor.getParam("paste_convert_word_fake_lists",!0)}(editor)&&function(node){for(var currentListNode,prevListNode,lastLevel=1,getText=function(node){var txt="";if(3===node.type)return node.value;if(node=node.firstChild)do{txt+=getText(node)}while(node=node.next);return txt},trimListStart=function(node,regExp){if(3===node.type&&regExp.test(node.value))return node.value=node.value.replace(regExp,""),!1;if(node=node.firstChild)do{if(!trimListStart(node,regExp))return!1}while(node=node.next);return!0},removeIgnoredNodes=function(node){if(node._listIgnore)node.remove();else if(node=node.firstChild)do{removeIgnoredNodes(node)}while(node=node.next)},convertParagraphToLi=function(paragraphNode,listName,start){var level=paragraphNode._listLevel||lastLevel;level!==lastLevel&&(level<lastLevel?currentListNode&&(currentListNode=currentListNode.parent.parent):(prevListNode=currentListNode,currentListNode=null)),currentListNode&&currentListNode.name===listName?currentListNode.append(paragraphNode):(prevListNode=prevListNode||currentListNode,currentListNode=new global$2(listName,1),start>1&&currentListNode.attr("start",""+start),paragraphNode.wrap(currentListNode)),paragraphNode.name="li",level>lastLevel&&prevListNode&&prevListNode.lastChild.append(currentListNode),lastLevel=level,removeIgnoredNodes(paragraphNode),trimListStart(paragraphNode,/^\u00a0+/),trimListStart(paragraphNode,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),trimListStart(paragraphNode,/^\u00a0+/)},elements=[],child=node.firstChild;null!=child;)if(elements.push(child),null!==(child=child.walk()))for(;void 0!==child&&child.parent!==node;)child=child.walk();for(var i=0;i<elements.length;i++)if("p"===(node=elements[i]).name&&node.firstChild){var nodeText=getText(node);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(nodeText)){convertParagraphToLi(node,"ul");continue}if(isNumericList(nodeText)){var matches=/([0-9]+)\./.exec(nodeText),start=1;matches&&(start=parseInt(matches[1],10)),convertParagraphToLi(node,"ol",start);continue}if(node._listLevel){convertParagraphToLi(node,"ul",1);continue}currentListNode=null}else prevListNode=currentListNode,currentListNode=null}(rootNode),content=global$3({validate:getValidate(editor)},schema).serialize(rootNode)},processResult=function(content,cancelled){return{content:content,cancelled:cancelled}},filterContent=function(editor,content,internal,isWordHtml){var preProcessArgs=function(editor,html,internal,isWordHtml){return editor.fire("PastePreProcess",{content:html,internal:internal,wordContent:isWordHtml})}(editor,content,internal,isWordHtml),filteredContent=function(editor,html){var parser=global$4({},editor.schema);parser.addNodeFilter("meta",(function(nodes){global$6.each(nodes,(function(node){node.remove()}))}));var fragment=parser.parse(html,{forced_root_block:!1,isRootContent:!0});return global$3({validate:getValidate(editor)},editor.schema).serialize(fragment)}(editor,preProcessArgs.content);return editor.hasEventListeners("PastePostProcess")&&!preProcessArgs.isDefaultPrevented()?function(editor,html,internal,isWordHtml){var tempBody=editor.dom.create("div",{style:"display:none"},html),postProcessArgs=function(editor,node,internal,isWordHtml){return editor.fire("PastePostProcess",{node:node,internal:internal,wordContent:isWordHtml})}(editor,tempBody,internal,isWordHtml);return processResult(postProcessArgs.node.innerHTML,postProcessArgs.isDefaultPrevented())}(editor,filteredContent,internal,isWordHtml):processResult(filteredContent,preProcessArgs.isDefaultPrevented())},process=function(editor,html,internal){var isWordHtml=isWordContent(html),content=isWordHtml?function(editor,content){return function(editor){return editor.getParam("paste_enable_default_filters",!0)}(editor)?filterWordContent(editor,content):content}(editor,html):html;return filterContent(editor,content,internal,isWordHtml)},pasteHtml$1=function(editor,html){return editor.insertContent(html,{merge:shouldMergeFormats(editor),paste:!0}),!0},isAbsoluteUrl=function(url){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(url)},isImageUrl=function(editor,url){return isAbsoluteUrl(url)&&exists(getAllowedImageFileTypes(editor),(function(type){return str=url.toLowerCase(),suffix="."+type.toLowerCase(),checkRange(str,suffix,str.length-suffix.length);var str,suffix}))},linkSelection=function(editor,html,pasteHtmlFn){return!(!1!==editor.selection.isCollapsed()||!isAbsoluteUrl(html))&&function(editor,url,pasteHtmlFn){return editor.undoManager.extra((function(){pasteHtmlFn(editor,url)}),(function(){editor.execCommand("mceInsertLink",!1,url)})),!0}(editor,html,pasteHtmlFn)},insertImage=function(editor,html,pasteHtmlFn){return!!isImageUrl(editor,html)&&function(editor,url,pasteHtmlFn){return editor.undoManager.extra((function(){pasteHtmlFn(editor,url)}),(function(){editor.insertContent('<img src="'+url+'">')})),!0}(editor,html,pasteHtmlFn)},insertContent=function(editor,html,pasteAsText){pasteAsText||!1===function(editor){return editor.getParam("smart_paste",!0)}(editor)?pasteHtml$1(editor,html):function(editor,html){global$6.each([linkSelection,insertImage,pasteHtml$1],(function(action){return!0!==action(editor,html,pasteHtml$1)}))}(editor,html)},isNewLineChar=function(c){return"\n"===c||"\r"===c},normalizeWhitespace=function(editor,text){var s,count,f,acc,tabSpace=(s=" ",(count=function(editor){return editor.getParam("paste_tab_spaces",4,"number")}(editor))<=0?"":new Array(count+1).join(s)),normalizedText=text.replace(/\t/g,tabSpace);return(f=function(acc,c){return function(c){return-1!==" \f\t\v".indexOf(c)}(c)||" "===c?acc.pcIsSpace||""===acc.str||acc.str.length===normalizedText.length-1||function(text,idx){return idx<text.length&&idx>=0&&isNewLineChar(text[idx])}(normalizedText,acc.str.length+1)?{pcIsSpace:!1,str:acc.str+" "}:{pcIsSpace:!0,str:acc.str+" "}:{pcIsSpace:isNewLineChar(c),str:acc.str+c}},acc={pcIsSpace:!1,str:""},each(normalizedText,(function(x,i){acc=f(acc,x,i)})),acc).str},doPaste=function(editor,content,internal,pasteAsText){var args=process(editor,content,internal);!1===args.cancelled&&insertContent(editor,args.content,pasteAsText)},pasteHtml=function(editor,html,internalFlag){var internal=internalFlag||isMarked(html);doPaste(editor,function(html){return html.replace("\x3c!-- x-tinymce/html --\x3e","")}(html),internal,!1)},pasteText=function(editor,text){var encodedText=editor.dom.encode(text).replace(/\r\n/g,"\n"),html=function(text,rootTag,rootAttrs){return rootTag?toBlockElements(text,!0===rootTag?"p":rootTag,rootAttrs):function(text){return text.replace(/\r?\n/g,"<br>")}(text)}(normalizeWhitespace(editor,encodedText),function(editor){return editor.getParam("forced_root_block")}(editor),function(editor){return editor.getParam("forced_root_block_attrs")}(editor));doPaste(editor,html,!1,!0)},getDataTransferItems=function(dataTransfer){var items={};if(dataTransfer){if(dataTransfer.getData){var legacyText=dataTransfer.getData("Text");legacyText&&legacyText.length>0&&-1===legacyText.indexOf("data:text/mce-internal,")&&(items["text/plain"]=legacyText)}if(dataTransfer.types)for(var i=0;i<dataTransfer.types.length;i++){var contentType=dataTransfer.types[i];try{items[contentType]=dataTransfer.getData(contentType)}catch(ex){items[contentType]=""}}}return items},hasContentType=function(clipboardContent,mimeType){return mimeType in clipboardContent&&clipboardContent[mimeType].length>0},hasHtmlOrText=function(content){return hasContentType(content,"text/html")||hasContentType(content,"text/plain")},uniqueId=(prefix="mceclip",count=0,function(){return prefix+count++}),pasteImage=function(editor,imageItem){var uri,matches,_a=(uri=imageItem.uri,(matches=/data:([^;]+);base64,([a-z0-9\+\/=]+)/i.exec(uri))?{type:matches[1],data:decodeURIComponent(matches[2])}:{type:null,data:null}),base64=_a.data,type=_a.type,id=uniqueId(),file=imageItem.blob,img=new Image;if(img.src=imageItem.uri,function(editor,imgElm){var filter=function(editor){return editor.getParam("images_dataimg_filter")}(editor);return!filter||filter(imgElm)}(editor,img)){var blobCache=editor.editorUpload.blobCache,blobInfo=void 0,existingBlobInfo=blobCache.getByData(base64,type);if(existingBlobInfo)blobInfo=existingBlobInfo;else{var useFileName=function(editor){return editor.getParam("images_reuse_filename")}(editor)&&isNonNullable(file.name),name_1=useFileName?function(editor,str){var m=str.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return isNonNullable(m)?editor.dom.encode(m[1]):null}(editor,file.name):id,filename=useFileName?file.name:void 0;blobInfo=blobCache.create(id,file,base64,name_1,filename),blobCache.add(blobInfo)}pasteHtml(editor,'<img src="'+blobInfo.blobUri()+'">',!1)}else pasteHtml(editor,'<img src="'+imageItem.uri+'">',!1)},readFilesAsDataUris=function(items){return global$8.all(map(items,(function(item){return new global$8((function(resolve){var blob=function(item){return isNonNullable(item.getAsFile)}(item)?item.getAsFile():item,reader=new window.FileReader;reader.onload=function(){resolve({blob:blob,uri:reader.result})},reader.readAsDataURL(blob)}))})))},isImage=function(editor){var allowedExtensions=getAllowedImageFileTypes(editor);return function(file){return function(str,prefix){return checkRange(str,prefix,0)}(file.type,"image/")&&exists(allowedExtensions,(function(extension){return lowerExt=extension.toLowerCase(),mimeOverrides={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"},(global$6.hasOwn(mimeOverrides,lowerExt)?"image/"+mimeOverrides[lowerExt]:"image/"+lowerExt)===file.type;var lowerExt,mimeOverrides}))}},pasteImageData=function(editor,e,rng){var dataTransfer="paste"===e.type?e.clipboardData:e.dataTransfer;if(getPasteDataImages(editor)&&dataTransfer){var images=function(editor,dataTransfer){var items=dataTransfer.items?bind(from(dataTransfer.items),(function(item){return"file"===item.kind?[item.getAsFile()]:[]})):[],files=dataTransfer.files?from(dataTransfer.files):[];return function(xs,pred){for(var r=[],i=0,len=xs.length;i<len;i++){var x=xs[i];pred(x,i)&&r.push(x)}return r}(items.length>0?items:files,isImage(editor))}(editor,dataTransfer);if(images.length>0)return e.preventDefault(),readFilesAsDataUris(images).then((function(fileResults){rng&&editor.selection.setRng(rng),each(fileResults,(function(result){pasteImage(editor,result)}))})),!0}return!1},isKeyboardPasteEvent=function(e){return global$7.metaKeyPressed(e)&&86===e.keyCode||e.shiftKey&&45===e.keyCode},registerEventHandlers=function(editor,pasteBin,pasteFormat){var keyboardPastePlainTextState,keyboardPasteEvent=value(),keyboardPastePressed=value();editor.on("keyup",keyboardPastePressed.clear),editor.on("keydown",(function(e){var removePasteBinOnKeyUp=function(e){isKeyboardPasteEvent(e)&&!e.isDefaultPrevented()&&pasteBin.remove()};if(isKeyboardPasteEvent(e)&&!e.isDefaultPrevented()){if((keyboardPastePlainTextState=e.shiftKey&&86===e.keyCode)&&global$a.webkit&&-1!==navigator.userAgent.indexOf("Version/"))return;if(e.stopImmediatePropagation(),keyboardPasteEvent.set(e),keyboardPastePressed.set(!0),global$a.ie&&keyboardPastePlainTextState)return e.preventDefault(),void function(editor,ieFake){editor.fire("paste",{ieFake:ieFake})}(editor,!0);pasteBin.remove(),pasteBin.create(),editor.once("keyup",removePasteBinOnKeyUp),editor.once("paste",(function(){editor.off("keyup",removePasteBinOnKeyUp)}))}}));var insertClipboardContent=function(editor,clipboardContent,isKeyBoardPaste,plainTextMode,internal){var content;hasContentType(clipboardContent,"text/html")?content=clipboardContent["text/html"]:(content=pasteBin.getHtml(),internal=internal||isMarked(content),pasteBin.isDefaultContent(content)&&(plainTextMode=!0)),content=trimHtml(content),pasteBin.remove();var isPlainTextHtml=!1===internal&&!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(content),isAbsoluteUrl$1=isAbsoluteUrl(content);(!content.length||isPlainTextHtml&&!isAbsoluteUrl$1)&&(plainTextMode=!0),(plainTextMode||isAbsoluteUrl$1)&&(content=hasContentType(clipboardContent,"text/plain")&&isPlainTextHtml?clipboardContent["text/plain"]:function(html){var schema=global$1(),domParser=global$4({},schema),text="",shortEndedElements=schema.getShortEndedElements(),ignoreElements=global$6.makeMap("script noscript style textarea video audio iframe object"," "),blockElements=schema.getBlockElements(),walk=function(node){var name=node.name,currentNode=node;if("br"!==name){if("wbr"!==name)if(shortEndedElements[name]&&(text+=" "),ignoreElements[name])text+=" ";else{if(3===node.type&&(text+=node.value),!node.shortEnded&&(node=node.firstChild))do{walk(node)}while(node=node.next);blockElements[name]&&currentNode.next&&(text+="\n","p"===name&&(text+="\n"))}}else text+="\n"};return html=filter(html,[/<!\[[^\]]+\]>/g]),walk(domParser.parse(html)),text}(content)),pasteBin.isDefaultContent(content)?isKeyBoardPaste||editor.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):plainTextMode?pasteText(editor,content):pasteHtml(editor,content,internal)};editor.on("paste",(function(e){var isKeyboardPaste=keyboardPasteEvent.isSet()||keyboardPastePressed.isSet();isKeyboardPaste&&keyboardPasteEvent.clear();var clipboardContent=function(editor,clipboardEvent){return getDataTransferItems(clipboardEvent.clipboardData||editor.getDoc().dataTransfer)}(editor,e),plainTextMode="text"===pasteFormat.get()||keyboardPastePlainTextState,internal=hasContentType(clipboardContent,internalHtmlMime());keyboardPastePlainTextState=!1,e.isDefaultPrevented()||function(e){var clipboardData=e.clipboardData;return-1!==navigator.userAgent.indexOf("Android")&&clipboardData&&clipboardData.items&&0===clipboardData.items.length}(e)?pasteBin.remove():hasHtmlOrText(clipboardContent)||!pasteImageData(editor,e,pasteBin.getLastRng()||editor.selection.getRng())?(isKeyboardPaste||e.preventDefault(),!global$a.ie||isKeyboardPaste&&!e.ieFake||hasContentType(clipboardContent,"text/html")||(pasteBin.create(),editor.dom.bind(pasteBin.getEl(),"paste",(function(e){e.stopPropagation()})),editor.getDoc().execCommand("Paste",!1,null),clipboardContent["text/html"]=pasteBin.getHtml()),hasContentType(clipboardContent,"text/html")?(e.preventDefault(),internal||(internal=isMarked(clipboardContent["text/html"])),insertClipboardContent(editor,clipboardContent,isKeyboardPaste,plainTextMode,internal)):global$9.setEditorTimeout(editor,(function(){insertClipboardContent(editor,clipboardContent,isKeyboardPaste,plainTextMode,internal)}),0)):pasteBin.remove()}))},getPasteBinParent=function(editor){return global$a.ie&&editor.inline?document.body:editor.getBody()},delegatePasteEvents=function(editor,pasteBinElm,pasteBinDefaultContent){(function(editor){return getPasteBinParent(editor)!==editor.getBody()})(editor)&&editor.dom.bind(pasteBinElm,"paste keyup",(function(_e){isDefault(editor,pasteBinDefaultContent)||editor.fire("paste")}))},getEl=function(editor){return editor.dom.get("mcepastebin")},isDefaultContent=function(pasteBinDefaultContent,content){return content===pasteBinDefaultContent},isDefault=function(editor,pasteBinDefaultContent){var elm,pasteBinElm=getEl(editor);return(elm=pasteBinElm)&&"mcepastebin"===elm.id&&isDefaultContent(pasteBinDefaultContent,pasteBinElm.innerHTML)},PasteBin=function(editor){var lastRng=Cell(null);return{create:function(){return function(editor,lastRngCell,pasteBinDefaultContent){var dom=editor.dom,body=editor.getBody();lastRngCell.set(editor.selection.getRng());var pasteBinElm=editor.dom.add(getPasteBinParent(editor),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},pasteBinDefaultContent);(global$a.ie||global$a.gecko)&&dom.setStyle(pasteBinElm,"left","rtl"===dom.getStyle(body,"direction",!0)?65535:-65535),dom.bind(pasteBinElm,"beforedeactivate focusin focusout",(function(e){e.stopPropagation()})),delegatePasteEvents(editor,pasteBinElm,pasteBinDefaultContent),pasteBinElm.focus(),editor.selection.select(pasteBinElm,!0)}(editor,lastRng,"%MCEPASTEBIN%")},remove:function(){return function(editor,lastRngCell){if(getEl(editor)){for(var pasteBinClone=void 0,lastRng=lastRngCell.get();pasteBinClone=editor.dom.get("mcepastebin");)editor.dom.remove(pasteBinClone),editor.dom.unbind(pasteBinClone);lastRng&&editor.selection.setRng(lastRng)}lastRngCell.set(null)}(editor,lastRng)},getEl:function(){return getEl(editor)},getHtml:function(){return function(editor){var copyAndRemove=function(toElm,fromElm){toElm.appendChild(fromElm),editor.dom.remove(fromElm,!0)},pasteBinClones=global$6.grep(getPasteBinParent(editor).childNodes,(function(elm){return"mcepastebin"===elm.id})),pasteBinElm=pasteBinClones.shift();global$6.each(pasteBinClones,(function(pasteBinClone){copyAndRemove(pasteBinElm,pasteBinClone)}));for(var dirtyWrappers=editor.dom.select("div[id=mcepastebin]",pasteBinElm),i=dirtyWrappers.length-1;i>=0;i--){var cleanWrapper=editor.dom.create("div");pasteBinElm.insertBefore(cleanWrapper,dirtyWrappers[i]),copyAndRemove(cleanWrapper,dirtyWrappers[i])}return pasteBinElm?pasteBinElm.innerHTML:""}(editor)},getLastRng:lastRng.get,isDefault:function(){return isDefault(editor,"%MCEPASTEBIN%")},isDefaultContent:function(content){return isDefaultContent("%MCEPASTEBIN%",content)}}},Clipboard=function(editor,pasteFormat){var pasteBin=PasteBin(editor);return editor.on("PreInit",(function(){return function(editor,pasteBin,pasteFormat){var src;registerEventHandlers(editor,pasteBin,pasteFormat),editor.parser.addNodeFilter("img",(function(nodes,name,args){var remove=function(node){node.attr("data-mce-object")||src===global$a.transparentSrc||node.remove()},isWebKitFakeUrl=function(src){return 0===src.indexOf("webkit-fake-url")},isDataUri=function(src){return 0===src.indexOf("data:")};if(!getPasteDataImages(editor)&&function(args){return args.data&&!0===args.data.paste}(args))for(var i=nodes.length;i--;)(src=nodes[i].attr("src"))&&(isWebKitFakeUrl(src)||!getAllowHtmlDataUrls(editor)&&isDataUri(src))&&remove(nodes[i])}))}(editor,pasteBin,pasteFormat)})),{pasteFormat:pasteFormat,pasteHtml:function(html,internalFlag){return pasteHtml(editor,html,internalFlag)},pasteText:function(text){return pasteText(editor,text)},pasteImageData:function(e,rng){return pasteImageData(editor,e,rng)},getDataTransferItems:getDataTransferItems,hasHtmlOrText:hasHtmlOrText,hasContentType:hasContentType}},register$2=function(editor,clipboard){editor.addCommand("mceTogglePlainTextPaste",(function(){!function(editor,clipboard){"text"===clipboard.pasteFormat.get()?(clipboard.pasteFormat.set("html"),firePastePlainTextToggle(editor,!1)):(clipboard.pasteFormat.set("text"),firePastePlainTextToggle(editor,!0)),editor.focus()}(editor,clipboard)})),editor.addCommand("mceInsertClipboardContent",(function(ui,value){value.content&&clipboard.pasteHtml(value.content,value.internal),value.text&&clipboard.pasteText(value.text)}))},setHtml5Clipboard=function(clipboardData,html,text){if(!function(clipboardData){return!1===global$a.iOS&&"function"==typeof(null==clipboardData?void 0:clipboardData.setData)}(clipboardData))return!1;try{return clipboardData.clearData(),clipboardData.setData("text/html",html),clipboardData.setData("text/plain",text),clipboardData.setData(internalHtmlMime(),html),!0}catch(e){return!1}},setClipboardData=function(evt,data,fallback,done){setHtml5Clipboard(evt.clipboardData,data.html,data.text)?(evt.preventDefault(),done()):fallback(data.html,done)},fallback=function(editor){return function(html,done){var markedHtml=function(html){return"\x3c!-- x-tinymce/html --\x3e"+html}(html),outer=editor.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),inner=editor.dom.create("div",{contenteditable:"true"},markedHtml);editor.dom.setStyles(outer,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),outer.appendChild(inner),editor.dom.add(editor.getBody(),outer);var range=editor.selection.getRng();inner.focus();var offscreenRange=editor.dom.createRng();offscreenRange.selectNodeContents(inner),editor.selection.setRng(offscreenRange),global$9.setTimeout((function(){editor.selection.setRng(range),outer.parentNode.removeChild(outer),done()}),0)}},getData=function(editor){return{html:editor.selection.getContent({contextual:!0}),text:editor.selection.getContent({format:"text"})}},hasSelectedContent=function(editor){return!editor.selection.isCollapsed()||function(editor){return!!editor.dom.getParent(editor.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",editor.getBody())}(editor)},register$1=function(editor){editor.on("cut",function(editor){return function(evt){hasSelectedContent(editor)&&setClipboardData(evt,getData(editor),fallback(editor),(function(){if(global$a.browser.isChrome()||global$a.browser.isFirefox()){var rng_1=editor.selection.getRng();global$9.setEditorTimeout(editor,(function(){editor.selection.setRng(rng_1),editor.execCommand("Delete")}),0)}else editor.execCommand("Delete")}))}}(editor)),editor.on("copy",function(editor){return function(evt){hasSelectedContent(editor)&&setClipboardData(evt,getData(editor),fallback(editor),noop)}}(editor))},global=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),getCaretRangeFromEvent=function(editor,e){return global.getCaretRangeFromPoint(e.clientX,e.clientY,editor.getDoc())},setFocusedRange=function(editor,rng){editor.focus(),editor.selection.setRng(rng)},addPreProcessFilter=function(editor,filterFunc){editor.on("PastePreProcess",(function(e){e.content=filterFunc(editor,e.content,e.internal,e.wordContent)}))},removeExplorerBrElementsAfterBlocks=function(editor,html){if(!isWordContent(html))return html;var blockElements=[];global$6.each(editor.schema.getBlockElements(),(function(block,blockName){blockElements.push(blockName)}));var explorerBlocksRegExp=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+blockElements.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return html=filter(html,[[explorerBlocksRegExp,"$1"]]),html=filter(html,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])},removeWebKitStyles=function(editor,content,internal,isWordHtml){if(isWordHtml||internal)return content;var webKitStyles,webKitStylesSetting=function(editor){return editor.getParam("paste_webkit_styles")}(editor);if(!1===function(editor){return editor.getParam("paste_remove_styles_if_webkit",!0)}(editor)||"all"===webKitStylesSetting)return content;if(webKitStylesSetting&&(webKitStyles=webKitStylesSetting.split(/[, ]/)),webKitStyles){var dom_1=editor.dom,node_1=editor.selection.getNode();content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(function(all,before,value,after){var inputStyles=dom_1.parseStyle(dom_1.decode(value)),outputStyles={};if("none"===webKitStyles)return before+after;for(var i=0;i<webKitStyles.length;i++){var inputValue=inputStyles[webKitStyles[i]],currentValue=dom_1.getStyle(node_1,webKitStyles[i],!0);/color/.test(webKitStyles[i])&&(inputValue=dom_1.toHex(inputValue),currentValue=dom_1.toHex(currentValue)),currentValue!==inputValue&&(outputStyles[webKitStyles[i]]=inputValue)}var outputStyle=dom_1.serializeStyle(outputStyles,"span");return outputStyle?before+' style="'+outputStyle+'"'+after:before+after}))}else content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return content=content.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(function(all,before,value,after){return before+' style="'+value+'"'+after}))},removeUnderlineAndFontInAnchor=function(editor,root){editor.$("a",root).find("font,u").each((function(i,node){editor.dom.remove(node,!0)}))},makeSetupHandler=function(editor,clipboard){return function(api){api.setActive("text"===clipboard.pasteFormat.get());var pastePlainTextToggleHandler=function(e){return api.setActive(e.state)};return editor.on("PastePlainTextToggle",pastePlainTextToggleHandler),function(){return editor.off("PastePlainTextToggle",pastePlainTextToggleHandler)}}};!function Plugin(){global$b.add("paste",(function(editor){if(!1===function(editor){return!!editor.hasPlugin("powerpaste",!0)&&(void 0!==window.console&&window.console.log&&window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)}(editor)){var draggingInternallyState=Cell(!1),pasteFormat=Cell(function(editor){return editor.getParam("paste_as_text",!1)}(editor)?"text":"html"),clipboard=Clipboard(editor,pasteFormat);return function(editor){global$a.webkit&&addPreProcessFilter(editor,removeWebKitStyles),global$a.ie&&(addPreProcessFilter(editor,removeExplorerBrElementsAfterBlocks),function(editor,filterFunc){editor.on("PastePostProcess",(function(e){filterFunc(editor,e.node)}))}(editor,removeUnderlineAndFontInAnchor))}(editor),function(editor,clipboard){var onAction=function(){return editor.execCommand("mceTogglePlainTextPaste")};editor.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:onAction,onSetup:makeSetupHandler(editor,clipboard)}),editor.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",icon:"paste-text",onAction:onAction,onSetup:makeSetupHandler(editor,clipboard)})}(editor,clipboard),register$2(editor,clipboard),function(editor){var plugin=editor.plugins.paste,preProcess=function(editor){return editor.getParam("paste_preprocess")}(editor);preProcess&&editor.on("PastePreProcess",(function(e){preProcess.call(plugin,plugin,e)}));var postProcess=function(editor){return editor.getParam("paste_postprocess")}(editor);postProcess&&editor.on("PastePostProcess",(function(e){postProcess.call(plugin,plugin,e)}))}(editor),register$1(editor),function(editor,clipboard,draggingInternallyState){(function(editor){return editor.getParam("paste_block_drop",!1)})(editor)&&editor.on("dragend dragover draggesture dragdrop drop drag",(function(e){e.preventDefault(),e.stopPropagation()})),shouldPasteDataImages(editor)||editor.on("drop",(function(e){var dataTransfer=e.dataTransfer;dataTransfer&&dataTransfer.files&&dataTransfer.files.length>0&&e.preventDefault()})),editor.on("drop",(function(e){var rng=getCaretRangeFromEvent(editor,e);if(!e.isDefaultPrevented()&&!draggingInternallyState.get()){var plainTextContent,dropContent=clipboard.getDataTransferItems(e.dataTransfer),internal=clipboard.hasContentType(dropContent,internalHtmlMime());if((clipboard.hasHtmlOrText(dropContent)&&(!(plainTextContent=dropContent["text/plain"])||0!==plainTextContent.indexOf("file://"))||!clipboard.pasteImageData(e,rng))&&rng&&function(editor){return editor.getParam("paste_filter_drop",!0)}(editor)){var content_1=dropContent["mce-internal"]||dropContent["text/html"]||dropContent["text/plain"];content_1&&(e.preventDefault(),global$9.setEditorTimeout(editor,(function(){editor.undoManager.transact((function(){dropContent["mce-internal"]&&editor.execCommand("Delete"),setFocusedRange(editor,rng),content_1=trimHtml(content_1),dropContent["text/html"]?clipboard.pasteHtml(content_1,internal):clipboard.pasteText(content_1)}))})))}}})),editor.on("dragstart",(function(_e){draggingInternallyState.set(!0)})),editor.on("dragover dragend",(function(e){shouldPasteDataImages(editor)&&!1===draggingInternallyState.get()&&(e.preventDefault(),setFocusedRange(editor,getCaretRangeFromEvent(editor,e))),"dragend"===e.type&&draggingInternallyState.set(!1)}))}(editor,clipboard,draggingInternallyState),function(clipboard){return{clipboard:clipboard}}(clipboard)}}))}()}();