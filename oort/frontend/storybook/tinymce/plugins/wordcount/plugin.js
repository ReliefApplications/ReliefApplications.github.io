!function(){"use strict";var global$2=tinymce.util.Tools.resolve("tinymce.PluginManager"),identity=function(x){return x},__assign=function(){return(__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},regExps_midnumlet="[-'\\.‘’․﹒＇．]",regExps_midletter="[:··״‧︓﹕：]",regExps_midnum="[±+*/,;;։،؍٬߸⁄︐︔﹐﹔，；]",regExps_numeric="[0-9٠-٩٫۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꩐-꩙꯰-꯹]",regExps_cr="\\r",regExps_lf="\\n",regExps_newline="[\v\f\u2028\u2029]",regExps_extend="[̀-ͯ҃-҉֑-ׇֽֿׁׂׅׄؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ऀ-ःऺ-़ा-ॏ॑-ॗॢॣঁ-ঃ়া-ৄেৈো-্ৗৢৣਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑੰੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣஂா-ூெ-ைொ-்ௗఁ-ఃా-ౄె-ైొ-్ౕౖౢౣಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣംഃാ-ൄെ-ൈൊ-്ൗൢൣංඃ්ා-ුූෘ-ෟෲෳัิ-ฺ็-๎ັິ-ູົຼ່-ໍ༹༘༙༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏႚ-ႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳា-៓៝᠋-᠍ᢩᤠ-ᤫᤰ-᤻ᦰ-ᧀᧈᧉᨗ-ᨛᩕ-ᩞ᩠-᩿᩼ᬀ-ᬄ᬴-᭄᭫-᭳ᮀ-ᮂᮡ-᯦᮪-᯳ᰤ-᰷᳐-᳔᳒-᳨᳭ᳲ᷀-ᷦ᷼-᷿‌‍⃐-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꙯-꙲꙼꙽꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-꣄꣠-꣱ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀ꨩ-ꨶꩃꩌꩍꩻꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꯣ-ꯪ꯬꯭ﬞ︀-️︠-︦ﾞﾟ]",regExps_format="[­؀-؃۝܏឴឵‎‏‪-‮⁠-⁤⁪-⁯\ufeff￹-￻]",regExps_katakana="[〱-〵゛゜゠-ヺー-ヿㇰ-ㇿ㋐-㋾㌀-㍗ｦ-ﾝ]",regExps_extendnumlet="[=_‿⁀⁔︳︴﹍-﹏＿∀-⋿<>]",regExps_punctuation="[!-#%-*,-\\/:;?@\\[-\\]_{}¡«·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]",characterIndices_ALETTER=0,characterIndices_MIDNUMLET=1,characterIndices_MIDLETTER=2,characterIndices_MIDNUM=3,characterIndices_NUMERIC=4,characterIndices_CR=5,characterIndices_LF=6,characterIndices_NEWLINE=7,characterIndices_EXTEND=8,characterIndices_FORMAT=9,characterIndices_KATAKANA=10,characterIndices_EXTENDNUMLET=11,characterIndices_AT=12,characterIndices_OTHER=13,SETS$1=[new RegExp("[A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-׳ؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆༀཀ-ཇཉ-ཬྈ-ྌႠ-Ⴥა-ჺჼᄀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᨀ-ᨖᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᯀ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⒶ-ⓩⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⴀ-ⴥⴰ-ⵥⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〻〼ㄅ-ㄭㄱ-ㆎㆠ-ㆺꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐꞑꞠ-ꞩꟺ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),new RegExp(regExps_midnumlet),new RegExp(regExps_midletter),new RegExp(regExps_midnum),new RegExp(regExps_numeric),new RegExp(regExps_cr),new RegExp(regExps_lf),new RegExp(regExps_newline),new RegExp(regExps_extend),new RegExp(regExps_format),new RegExp(regExps_katakana),new RegExp(regExps_extendnumlet),new RegExp("@")],PUNCTUATION$1=new RegExp("^"+regExps_punctuation+"$"),SETS=SETS$1,OTHER=characterIndices_OTHER,getType=function(char){for(var type=OTHER,setsLength=SETS.length,j=0;j<setsLength;++j){var set=SETS[j];if(set&&set.test(char)){type=j;break}}return type},classify=function(characters){var func,cache;return function(xs,f){for(var len=xs.length,r=new Array(len),i=0;i<len;i++){var x=xs[i];r[i]=f(x,i)}return r}(characters,(func=getType,cache={},function(char){if(cache[char])return cache[char];var result=func(char);return cache[char]=result,result}))},isWordBoundary=function(map,index){var type=map[index],nextType=map[index+1];if(index<0||index>map.length-1&&0!==index)return!1;if(type===characterIndices_ALETTER&&nextType===characterIndices_ALETTER)return!1;var nextNextType=map[index+2];if(type===characterIndices_ALETTER&&(nextType===characterIndices_MIDLETTER||nextType===characterIndices_MIDNUMLET||nextType===characterIndices_AT)&&nextNextType===characterIndices_ALETTER)return!1;var prevType=map[index-1];return(type!==characterIndices_MIDLETTER&&type!==characterIndices_MIDNUMLET&&nextType!==characterIndices_AT||nextType!==characterIndices_ALETTER||prevType!==characterIndices_ALETTER)&&((type!==characterIndices_NUMERIC&&type!==characterIndices_ALETTER||nextType!==characterIndices_NUMERIC&&nextType!==characterIndices_ALETTER)&&((type!==characterIndices_MIDNUM&&type!==characterIndices_MIDNUMLET||nextType!==characterIndices_NUMERIC||prevType!==characterIndices_NUMERIC)&&((type!==characterIndices_NUMERIC||nextType!==characterIndices_MIDNUM&&nextType!==characterIndices_MIDNUMLET||nextNextType!==characterIndices_NUMERIC)&&(type!==characterIndices_EXTEND&&type!==characterIndices_FORMAT&&prevType!==characterIndices_EXTEND&&prevType!==characterIndices_FORMAT&&nextType!==characterIndices_EXTEND&&nextType!==characterIndices_FORMAT&&((type!==characterIndices_CR||nextType!==characterIndices_LF)&&(type===characterIndices_NEWLINE||type===characterIndices_CR||type===characterIndices_LF||(nextType===characterIndices_NEWLINE||nextType===characterIndices_CR||nextType===characterIndices_LF||(type!==characterIndices_KATAKANA||nextType!==characterIndices_KATAKANA)&&((nextType!==characterIndices_EXTENDNUMLET||type!==characterIndices_ALETTER&&type!==characterIndices_NUMERIC&&type!==characterIndices_KATAKANA&&type!==characterIndices_EXTENDNUMLET)&&((type!==characterIndices_EXTENDNUMLET||nextType!==characterIndices_ALETTER&&nextType!==characterIndices_NUMERIC&&nextType!==characterIndices_KATAKANA)&&type!==characterIndices_AT)))))))))},WHITESPACE=/^\s+$/,PUNCTUATION=PUNCTUATION$1,isProtocol=function(str){return"http"===str||"https"===str},findUrlEnd=function(characters,startIndex){var endIndex=function(characters,startIndex){var i;for(i=startIndex;i<characters.length&&!WHITESPACE.test(characters[i]);i++);return i}(characters,startIndex+1);return"://"===characters.slice(startIndex+1,endIndex).join("").substr(0,3)?endIndex:startIndex},getWords=function(chars,extract,options){options=__assign(__assign({},{includeWhitespace:!1,includePunctuation:!1}),options);for(var filteredChars=[],extractedChars=[],i=0;i<chars.length;i++){var ch=extract(chars[i]);"\ufeff"!==ch&&(filteredChars.push(chars[i]),extractedChars.push(ch))}return function(chars,sChars,characterMap,options){for(var words=[],word=[],i=0;i<characterMap.length;++i)if(word.push(chars[i]),isWordBoundary(characterMap,i)){var ch=sChars[i];if((options.includeWhitespace||!WHITESPACE.test(ch))&&(options.includePunctuation||!PUNCTUATION.test(ch))){var startOfWord=i-word.length+1,endOfWord=i+1,str=sChars.slice(startOfWord,endOfWord).join("");if(isProtocol(str)){var endOfUrl=findUrlEnd(sChars,i),url=chars.slice(endOfWord,endOfUrl);Array.prototype.push.apply(word,url),i=endOfUrl}words.push(word)}word=[]}return words}(filteredChars,extractedChars,classify(extractedChars),options)},global$1=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),getText=function(node,schema){for(var blockElements=schema.getBlockElements(),shortEndedElements=schema.getShortEndedElements(),isNewline=function(node){return blockElements[node.nodeName]||shortEndedElements[node.nodeName]},textBlocks=[],txt="",treeWalker=new global$1(node,node);node=treeWalker.next();)3===node.nodeType?txt+=node.data.replace(/\uFEFF/g,""):isNewline(node)&&txt.length&&(textBlocks.push(txt),txt="");return txt.length&&textBlocks.push(txt),textBlocks},strLen=function(str){return str.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length},countWords=function(node,schema){var text=function(text){return text.replace(/\u200B/g,"")}(getText(node,schema).join("\n"));return getWords(text.split(""),identity).length},countCharacters=function(node,schema){var text=getText(node,schema).join("");return strLen(text)},countCharactersWithoutSpaces=function(node,schema){var text=getText(node,schema).join("").replace(/\s/g,"");return strLen(text)},createBodyCounter=function(editor,count){return function(){return count(editor.getBody(),editor.schema)}},createSelectionCounter=function(editor,count){return function(){return count(editor.selection.getRng().cloneContents(),editor.schema)}},createBodyWordCounter=function(editor){return createBodyCounter(editor,countWords)},register$1=function(editor,api){editor.addCommand("mceWordCount",(function(){return function(editor,api){editor.windowManager.open({title:"Word Count",body:{type:"panel",items:[{type:"table",header:["Count","Document","Selection"],cells:[["Words",String(api.body.getWordCount()),String(api.selection.getWordCount())],["Characters (no spaces)",String(api.body.getCharacterCountWithoutSpaces()),String(api.selection.getCharacterCountWithoutSpaces())],["Characters",String(api.body.getCharacterCount()),String(api.selection.getCharacterCount())]]}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}]})}(editor,api)}))},global=tinymce.util.Tools.resolve("tinymce.util.Delay"),updateCount=function(editor,api){!function(editor,api){editor.fire("wordCountUpdate",{wordCount:{words:api.body.getWordCount(),characters:api.body.getCharacterCount(),charactersWithoutSpaces:api.body.getCharacterCountWithoutSpaces()}})}(editor,api)};!function Plugin(delay){void 0===delay&&(delay=300),global$2.add("wordcount",(function(editor){var api=function(editor){return{body:{getWordCount:createBodyWordCounter(editor),getCharacterCount:createBodyCounter(editor,countCharacters),getCharacterCountWithoutSpaces:createBodyCounter(editor,countCharactersWithoutSpaces)},selection:{getWordCount:createSelectionCounter(editor,countWords),getCharacterCount:createSelectionCounter(editor,countCharacters),getCharacterCountWithoutSpaces:createSelectionCounter(editor,countCharactersWithoutSpaces)},getCount:createBodyWordCounter(editor)}}(editor);return register$1(editor,api),function(editor){var onAction=function(){return editor.execCommand("mceWordCount")};editor.ui.registry.addButton("wordcount",{tooltip:"Word count",icon:"character-count",onAction:onAction}),editor.ui.registry.addMenuItem("wordcount",{text:"Word count",icon:"character-count",onAction:onAction})}(editor),function(editor,api,delay){var debouncedUpdate=global.debounce((function(){return updateCount(editor,api)}),delay);editor.on("init",(function(){updateCount(editor,api),global.setEditorTimeout(editor,(function(){editor.on("SetContent BeforeAddUndo Undo Redo ViewUpdate keyup",debouncedUpdate)}),0)}))}(editor,api,delay),api}))}()}();